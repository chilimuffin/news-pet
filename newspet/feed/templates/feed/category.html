{% extends "base.html" %}
{% load feedtags %}

{% block extrahead %}
<script>
function change_category(id){
    $('#'+id).replaceWith('<form class="category-select" method="post" action="{% url f_move_item category.id %}" id="form-'+id+'">{% get_category_select user %}</div>');
    $("#form-"+id+" select")
        .change(function(){
            $("#form-"+id).get(0).submit()
        });
}
$(function() {
    $(".star").hover(turn_gold, turn_blue)
})
function turn_gold(e){
    $(this).attr('src', '{{MEDIA_URL}}img/gold_star.png')
}
function turn_blue(e){
    $(this).attr('src', '{{MEDIA_URL}}img/star.png')
}
</script>
{% endblock %}

{% block content %}
<h1>{{category}}</h1>
{% if category.feed_items %}
{% for item in category.feed_items %}
<div class="post list-element">
<div class="post-header">
    <div>
        <h1><a href='{{item.get_internal_url}}'>{{item.title}}</a></h1>
        <ul>
            {% if item.is_liked %}
            <li><img class="gold-star" src={{MEDIA_URL}}img/gold_star.png></li>
            {% else %}
            <li><a href="{% url f_love_item item.id %}"><img class="star" src="{{MEDIA_URL}}img/star.png"></a></li>
            {% endif %}
            <li><span id="category-list-{{item.id}}" class='category-name'>{{item.category}}</span> <a class="change" href="javascript:change_category('category-list-{{item.id}}')">Move Item</a>
        </ul>
    </div>
    <div>
        <p class="author"><span>from</span> <a href="#">{{item.feed}}</a></p>
    </div>
</div>
<div class="post-body">
    {{item.safe_body}}
</div>
{% endfor %}
{% else %}
<p>There are no items in this category yet</p>
{% endif %}
{% endblock %}